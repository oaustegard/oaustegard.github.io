<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webex IM Space Forwarder</title>
    <style>
        body {font-family: Arial, Helvetica, sans-serif; margin-left: 50px}
    </style>
</head>
<body>
    <p><a href="javascript:history.back()">Back...</a></p>
    <h1>Webex IM Space Forwarder</h1>
    <p>This is a web page that forwards to a Webex instant messaging space, based on the query string passed to the page, allowing you 
        to safely and effectively create <code>webexteams://</code> protocol links where only <code>http/s</code> protocol 
        links are allowed (such as Jira, Confluence, Sharepoint, etc).</p>
    <p>Webex Space links can be found in the Space &#9881; menu. </p>
    <p>The format of a space link will look like this: <pre><a id="wx" href="webexteams://im?space=0016f1c0-b427-11eb-be54-3d20da285cb4">webexteams://im?space=0016f1c0-b427-11eb-be54-3d20da285cb4</a></pre></p>
    <p>To use this page as a webex forwarder, call this page with a query string suffix like this:<br/>
    <pre><a id="lnk" href="webex.html?space=0016f1c0-b427-11eb-be54-3d20da285cb4">webex.aspx?space=0016f1c0-b427-11eb-be54-3d20da285cb4</a></pre></p>
    <p>Note: The first time you'll likely need to allow this site to serve pop ups as the link will open in a new window</p>
    <p><a href="javascript:history.back()">Back...</a></p>
    <p><a href="https://github.com/oaustegard/oaustegard.github.io/webex.html">View this page's code on GitHub</a></p>

    <script>
        let q = new URLSearchParams(window.location.search);
        let space = q.get('space');
        var spaceRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;
        if (space && spaceRegex.test(space)) {
            let url = 'webexteams://im?space=' + space;
            wx = document.getElementById('wx')
            wx.href = url;
            wx.innerText = url;

            let lnkurl = window.location.href;
            lnk = document.getElementById('lnk')
            lnk.href = lnkurl;
            lnk.innerText = lnkurl;

            window.open(url);
        }
    </script>
</body>
</html>